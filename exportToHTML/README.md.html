<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cf8e6d;}
.s1 { color: #bcbec4;}
.s2 { color: #bcbec4;}
.s3 { color: #6aab73;}
.s4 { color: #c77dbb; font-style: italic;}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
README.md</font>
</center></td></tr></table>
<pre><span class="s0"># </span><span class="s2">Global Air Network Socio-Economic Analysis</span>

<span class="s0">## </span><span class="s2">Project Overview</span>

<span class="s2">This project aims to analyze the structure of the </span><span class="s1">**</span><span class="s2">Global Air Transportation Network</span><span class="s1">** </span><span class="s2">by integrating it with </span><span class="s1">**</span><span class="s2">country-level economic indicators</span><span class="s1">**</span><span class="s2">. The goal is to move beyond simple network connectivity to explore complex analytical questions regarding how national wealth, stability, and air travel infrastructure correlate.</span>
<span class="s0">---</span>

<span class="s0">## </span><span class="s2">Setup and Data Ingestion</span>

<span class="s2">This project utilizes `compose.yml` to set up the necessary database environment. Data is then ingested into the database using the `ingestion.sql` script, which populates the tables with cleaned and processed data.</span>

<span class="s0">---</span>

<span class="s0">## </span><span class="s2">Data Sources</span>

<span class="s2">The project uses a foundation of core aviation data enriched by external, authoritative sources, with all processed data residing in the `clean_data` directory for ingestion.</span>

<span class="s0">| </span><span class="s1">Source Name </span><span class="s0">| </span><span class="s1">Data Type </span><span class="s0">| </span><span class="s1">Key Linking Fields </span><span class="s0">| </span><span class="s1">URL </span><span class="s0">|</span>
<span class="s0">| :--- | :--- | :--- | :--- |</span>
<span class="s0">| </span><span class="s1">**Global Air Transportation Network** (Kaggle) </span><span class="s0">| </span><span class="s1">Core Aviation Data </span><span class="s0">| </span><span class="s1">N/A (Internal) </span><span class="s0">| </span><span class="s1">`https://www.kaggle.com/datasets/thedevastator/global-air-transportation-network-mapping-the-wo/data` </span><span class="s0">|</span>
<span class="s0">| </span><span class="s1">**World Bank DataBank** </span><span class="s0">| </span><span class="s1">Country Economic Data </span><span class="s0">| </span><span class="s1">`country` </span><span class="s0">| </span><span class="s1">`https://databank.worldbank.org/source/world-development-indicators` </span><span class="s0">|</span>

<span class="s0">---</span>

<span class="s0">## </span><span class="s2">Database Schema</span>

<span class="s2">The database will consist of six primary tables. The linkages are defined by aviation codes </span><span class="s1">(</span><span class="s2">IATA/ICAO</span><span class="s1">) </span><span class="s2">and geographical names.</span>

<span class="s0">### </span><span class="s2">Core Aviation Tables </span><span class="s1">(</span><span class="s2">4</span><span class="s1">)</span>

<span class="s0">| </span><span class="s1">Table Name </span><span class="s0">| </span><span class="s1">Description </span><span class="s0">| </span><span class="s1">Key Columns </span><span class="s0">|</span>
<span class="s0">| :--- | :--- | :--- |</span>
<span class="s0">| </span><span class="s1">`airlines` </span><span class="s0">| </span><span class="s1">Carrier details and operational status. </span><span class="s0">| </span><span class="s1">`Airline_ID` (PK), `Name`, `Alias`, `IATA`, `ICAO`, `Callsign`, `Active` </span><span class="s0">|</span>
<span class="s0">| </span><span class="s1">`airplanes` </span><span class="s0">| </span><span class="s1">Aircraft model and identification codes. </span><span class="s0">| </span><span class="s1">`IATA` (PK), `Name`, `ICAO` </span><span class="s0">|</span>
<span class="s0">| </span><span class="s1">`airports` </span><span class="s0">| </span><span class="s1">Geographic and infrastructure data for every airport. </span><span class="s0">| </span><span class="s1">`Airport_ID` (PK), `Name`, `City`, `Country`, `IATA`, `ICAO`, `Latitude`, `Longitude`, `Altitude`, `Timezone`, `DST`, `Tz_database_time_zone`, `Type`, `Source` (FK to `countries.Country_Name`) </span><span class="s0">|</span>
<span class="s0">| </span><span class="s1">`routes` </span><span class="s0">| </span><span class="s1">Defined flight segments between two airports. </span><span class="s0">| </span><span class="s1">`Routes_ID` (PK), `Airline` (Name), `Airline_ID` (FK to `airlines.Airline_ID`), `Source_airport` (IATA/ICAO), `Source_airport_ID` (FK to `airports.Airport_ID`), `Destination_airport` (IATA/ICAO), `Destination_airport_ID` (FK to `airports.Airport_ID`), `Codeshare`, `Stops`, `Equipment` </span><span class="s0">|</span>

<span class="s0">### </span><span class="s2">Enrichment Tables </span><span class="s1">(</span><span class="s2">1</span><span class="s1">)</span>

<span class="s2">This table introduces the socio-economic context for analysis.</span>

<span class="s0">| </span><span class="s1">Table Name </span><span class="s0">| </span><span class="s1">Source </span><span class="s0">| </span><span class="s1">Key Columns </span><span class="s0">| </span><span class="s1">Linkage to `airports` </span><span class="s0">|</span>
<span class="s0">| :--- | :--- | :--- | :--- |</span>
<span class="s0">| </span><span class="s1">`countries` </span><span class="s0">| </span><span class="s1">World Bank </span><span class="s0">| </span><span class="s1">**`Country_Name`** (PK), `Time`, `Time_Code`, `Country_Code`, `GDP_current_US`, `GDP_per_capita_current_US`, `Political_Stability`, `Population` </span><span class="s0">| </span><span class="s1">**Ideal:** `airports.Country` $\leftrightarrow$ `countries.Country_Name` </span><span class="s0">|</span>

<span class="s0">---</span>

<span class="s0">## </span><span class="s2">Data Cleaning</span>

<span class="s2">Our data cleaning process makes sure all the information is accurate and works well together. This involves</span><span class="s1">:</span>

<span class="s0">*   </span><span class="s1">**</span><span class="s2">Making Country Names Consistent</span><span class="s1">:** </span><span class="s2">We find all unique country names from airport data. Then, we match country names from the economic </span><span class="s1">(</span><span class="s2">GDP</span><span class="s1">) </span><span class="s2">data to these standard names, creating a lookup table. As a first step, a fuzzy algorithm was used, matching everything above a 90% similarity. What remained was then matched by hand. This is necessary to ensure name consistency across datasets.</span>
<span class="s0">*   </span><span class="s1">**</span><span class="s2">Connecting Economic Data</span><span class="s1">:** </span><span class="s2">We link the economic data </span><span class="s1">(</span><span class="s2">GDP</span><span class="s1">) </span><span class="s2">with the airline and airport information. This means we only keep economic data for countries that appear in our aviation data. If a country is in our aviation data but not in the original economic data, we add it with empty economic values.</span>
<span class="s0">*   </span><span class="s1">**</span><span class="s2">Cleaning and Checking Flight Routes</span><span class="s1">:**</span>
    <span class="s0">*   </span><span class="s1">**</span><span class="s2">Fixing Missing IDs</span><span class="s1">:** </span><span class="s2">If some airport IDs are missing in the flight route data, we try to find them using airport names. If we can't find an ID, we remove that flight route. We also remove routes with airline IDs that aren't valid.</span>
    <span class="s0">*   </span><span class="s1">**</span><span class="s2">Standardizing </span><span class="s1">&quot;</span><span class="s2">Codeshare</span><span class="s1">&quot;:** </span><span class="s2">The </span><span class="s1">&quot;</span><span class="s2">Codeshare</span><span class="s1">&quot; </span><span class="s2">column </span><span class="s1">(</span><span class="s2">which shows if a flight is shared between airlines</span><span class="s1">) </span><span class="s2">is changed to a simple </span><span class="s1">&quot;</span><span class="s2">0</span><span class="s1">&quot; (</span><span class="s2">no</span><span class="s1">) </span><span class="s2">or </span><span class="s1">&quot;</span><span class="s2">1</span><span class="s1">&quot; (</span><span class="s2">yes</span><span class="s1">)</span><span class="s2">.</span>
    <span class="s0">*   </span><span class="s1">**</span><span class="s2">Ensuring All Connections Are Correct</span><span class="s1">:** </span><span class="s2">We thoroughly check that every flight route correctly links to existing airline IDs, airport IDs </span><span class="s1">(</span><span class="s2">for departure and arrival</span><span class="s1">)</span><span class="s2">, and airplane types. If not, it is removed.</span>
<span class="s0">*   </span><span class="s1">**</span><span class="s2">Removing Extra Information</span><span class="s1">:** </span><span class="s2">We remove duplicate ID codes </span><span class="s1">(</span><span class="s2">IATA/ICAO</span><span class="s1">) </span><span class="s2">in the airplane data to make sure each code is unique. Also, an unnecessary </span><span class="s1">&quot;</span><span class="s2">index</span><span class="s1">&quot; </span><span class="s2">column is taken out of the airline data.</span>
<span class="s0">*   </span><span class="s1">**</span><span class="s2">Ensuring that each table has a unique and non-null primary key</span><span class="s1">:** </span><span class="s2">For each table, a suitable primary key was selected. If a row had no value, we removed it.</span>

<span class="s0">---</span>

<span class="s0"># </span><span class="s2">Documentation of Question Design, Adjustments, and Results</span>

<span class="s0">##  </span><span class="s2">Database Connection Setup</span>

<span class="s2">All analytical SQL queries were executed from a Jupyter Notebook, using a PostgreSQL database running inside Docker. After starting the environment via</span><span class="s1">:</span>

<span class="s0">```</span>
<span class="s3">docker compose up -d</span>
<span class="s0">```</span>

<span class="s2">the PostgreSQL server becomes available at</span><span class="s1">:</span>

<span class="s0">* </span><span class="s1">**</span><span class="s2">Host</span><span class="s1">:** </span><span class="s2">`localhost`</span>
<span class="s0">* </span><span class="s1">**</span><span class="s2">Port</span><span class="s1">:** </span><span class="s2">`5432`</span>
<span class="s0">* </span><span class="s1">**</span><span class="s2">User</span><span class="s1">:** </span><span class="s2">`postgres`</span>
<span class="s0">* </span><span class="s1">**</span><span class="s2">Password</span><span class="s1">:** </span><span class="s2">`postgres`</span>
<span class="s0">* </span><span class="s1">**</span><span class="s2">Database</span><span class="s1">:** </span><span class="s2">`postgres`</span>

<span class="s2">We connect to this database using SQLAlchemy</span><span class="s1">:</span>

<span class="s0">```</span><span class="s4">python</span>
<span class="s3">from sqlalchemy import create_engine</span>
<span class="s3">import pandas as pd</span>

<span class="s3">engine = create_engine(&quot;postgresql://postgres:postgres@localhost:5432/postgres&quot;)</span>
<span class="s0">```</span>

<span class="s2">All queries are executed using</span><span class="s1">:</span>

<span class="s0">```</span><span class="s4">python</span>
<span class="s3">pd.read_sql(query, engine)</span>
<span class="s0">```</span>


<span class="s0">## </span><span class="s2">Question 1 </span><span class="s1">(</span><span class="s2">Basic RA</span><span class="s1">: </span><span class="s2">Select + Projection</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">Which airlines are inactive? Provide ID and name.</span>


<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question01 = &quot;&quot;&quot;</span>
<span class="s3">SELECT </span>
    <span class="s3">&quot;Airline_ID&quot;,</span>
    <span class="s3">&quot;Name&quot;</span>
<span class="s3">FROM airlines</span>
<span class="s3">WHERE &quot;Active&quot; = 'N';</span>
<span class="s3">&quot;&quot;&quot;</span>
<span class="s3">q1_df = pd.read_sql(query_question01, engine)</span>
<span class="s3">q1_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>
<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Airline_ID&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Name&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;2&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;135 Airways&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;4&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;2 Sqn No 1 Elementary Flying Training School&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;5&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;213 Flight Unit&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;6&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;223 Flight Unit State Airline&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;7&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;224th Flight Unit&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;...&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4901&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;20963&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Atlantic Air Cargo&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4902&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;21056&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Dummy&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4903&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;21181&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Air Andaman (2Y)&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4904&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;21240&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;TDA Toa Domestic Airlines&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4905&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;21251&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Lynx Aviation (L3/SSX)&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;p&gt;4906 rows × 2 columns&lt;/p&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s0">## </span><span class="s2">Relational Algebra Question 01</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q1RA.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 2 </span><span class="s1">(</span><span class="s2">Basic RA</span><span class="s1">: </span><span class="s2">Union</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">Show all airprts located in either Germany or Austria. Include name, city, and country.</span>


<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question02 = &quot;&quot;&quot;</span>
<span class="s3">SELECT </span>
    <span class="s3">&quot;Name&quot;,</span>
    <span class="s3">&quot;City&quot;,</span>
    <span class="s3">&quot;Country&quot;</span>
<span class="s3">FROM airports</span>
<span class="s3">WHERE &quot;Country&quot; = 'Germany'</span>
<span class="s3">UNION</span>
<span class="s3">SELECT </span>
    <span class="s3">&quot;Name&quot;,</span>
    <span class="s3">&quot;City&quot;,</span>
    <span class="s3">&quot;Country&quot;</span>
<span class="s3">FROM airports</span>
<span class="s3">WHERE &quot;Country&quot; = 'Austria'</span>
<span class="s3">&quot;&quot;&quot;</span>

<span class="s3">q2_df = pd.read_sql(query_question02, engine)</span>
<span class="s3">q2_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Name&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;City&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Country&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Hamburg Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Hamburg&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Geilenkirchen Air Base&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Geilenkirchen&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Vilshofen Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Vilshofen&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;St. Johann In Tirol Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;St. Johann in Tirol&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Austria&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Wipperfürth-Neye Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Wipperfuerth&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;...&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;264&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Hohn Air Base&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Hohn&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;265&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Rügen Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Ruegen&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;266&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Torgau-Beilrode Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Gransee&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;267&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Aalen-Heidenheim/Elchingen Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Aalen-heidenheim&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;268&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Rothenburg/Görlitz Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Rothenburg/ol&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;p&gt;269 rows × 3 columns&lt;/p&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s0">## </span><span class="s2">Relational Algebra Question 02</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q2Ra.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 3 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Join</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">Show all routes with one stop with the name of the airline, the departure and arrival airports </span><span class="s1">(</span><span class="s2">IATA codes</span><span class="s1">)</span><span class="s2">.</span>

<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question03 = &quot;&quot;&quot;</span>
<span class="s3">SELECT </span>
    <span class="s3">a.&quot;Name&quot;,</span>
    <span class="s3">r.&quot;Source_airport&quot;,</span>
    <span class="s3">r.&quot;Destination_airport&quot;</span>
<span class="s3">FROM routes r</span>
<span class="s3">JOIN airlines a ON r.&quot;Airline_ID&quot; = a.&quot;Airline_ID&quot;</span>
<span class="s3">WHERE r.&quot;Stops&quot; = 1</span>
<span class="s3">&quot;&quot;&quot;</span>

<span class="s3">q3_df = pd.read_sql(query_question03, engine)</span>
<span class="s3">q3_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Name&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Source_airport&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Destination_airport&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Canadian North&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;YRT&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;YEK&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Air Canada&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;ABJ&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;BRU&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Air Canada&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;YVR&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;YBL&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Cubana de Aviación&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;FCO&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;HAV&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;AirTran Airways&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;HOU&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;SAT&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;5&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;AirTran Airways&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;MCO&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;ORF&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;6&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Scandinavian Airlines System&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;ARN&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;GEV&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s0">## </span><span class="s2">Relational Algebra Question 03</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q3RA.jpeg</span><span class="s1">)</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q3RA2.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 4 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Aggregate Functions</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">How many routes does each airline have?</span>


<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question04 = &quot;&quot;&quot;</span>
<span class="s3">SELECT </span>
    <span class="s3">a.&quot;Name&quot;,</span>
    <span class="s3">COUNT(*) AS Route_Count</span>
<span class="s3">FROM routes r</span>
<span class="s3">JOIN airlines a ON r.&quot;Airline_ID&quot; = a.&quot;Airline_ID&quot;</span>
<span class="s3">GROUP BY a.&quot;Name&quot;</span>
<span class="s3">HAVING COUNT(*) &gt; 80;</span>
<span class="s3">&quot;&quot;&quot;</span>
<span class="s3">q4_df = pd.read_sql(query_question04, engine)</span>
<span class="s3">q4_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Name&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;route_count&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Air Bourbon&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;210&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;TransAsia Airways&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;92&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Air India Limited&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;364&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Meridiana&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;140&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;EVA Air&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;114&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;...&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;136&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;LOT Polish Airlines&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;114&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;137&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Sriwijaya Air&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;106&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;138&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;LAN Airlines&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;285&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;139&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Iberia Airlines&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;797&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;140&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Philippine Airlines&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;144&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;p&gt;141 rows × 2 columns&lt;/p&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q4RA.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 5 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Aggregate Functions</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">Which countries have the highest percentage of domestic routes?</span>

<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question05 = &quot;&quot;&quot;</span>
<span class="s3">WITH route_with_countries AS (</span>
    <span class="s3">SELECT</span>
        <span class="s3">r.&quot;Routes_ID&quot;,</span>
        <span class="s3">src_c.&quot;Country_Name&quot;  AS src_country,</span>
        <span class="s3">dest_c.&quot;Country_Name&quot; AS dest_country</span>
    <span class="s3">FROM routes r</span>
    <span class="s3">JOIN airports src_a </span>
        <span class="s3">ON r.&quot;Source_airport&quot; = src_a.&quot;IATA&quot;</span>
    <span class="s3">JOIN countries src_c </span>
        <span class="s3">ON src_a.&quot;Country&quot; = src_c.&quot;Country_Name&quot;</span>
    <span class="s3">JOIN airports dest_a </span>
        <span class="s3">ON r.&quot;Destination_airport&quot; = dest_a.&quot;IATA&quot;</span>
    <span class="s3">JOIN countries dest_c </span>
        <span class="s3">ON dest_a.&quot;Country&quot; = dest_c.&quot;Country_Name&quot;</span>
<span class="s3">),</span>
<span class="s3">route_stats AS (</span>
    <span class="s3">SELECT</span>
        <span class="s3">src_country AS country,</span>
        <span class="s3">COUNT(*) AS total_routes,</span>
        <span class="s3">COUNT(*) FILTER (WHERE src_country = dest_country) AS domestic_routes</span>
    <span class="s3">FROM route_with_countries</span>
    <span class="s3">GROUP BY src_country</span>
<span class="s3">)</span>
<span class="s3">SELECT</span>
    <span class="s3">country,</span>
    <span class="s3">total_routes,</span>
    <span class="s3">domestic_routes,</span>
    <span class="s3">domestic_routes::FLOAT / total_routes AS domestic_share</span>
<span class="s3">FROM route_stats</span>
<span class="s3">WHERE total_routes &gt;= 100</span>
<span class="s3">ORDER BY domestic_share DESC</span>
<span class="s3">LIMIT 15;</span>
<span class="s3">&quot;&quot;&quot;</span>

<span class="s3">q5_df = pd.read_sql(query_question05, engine)</span>
<span class="s3">q5_df</span>

<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;country&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;total_routes&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;domestic_routes&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;domestic_share&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;China&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;7894&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;6743&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.854193&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Brazil&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1325&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1129&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.852075&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;French Polynesia&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;108&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;91&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.842593&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Indonesia&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;817&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;603&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.738066&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Iran, Islamic Rep.&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;356&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;257&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.721910&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;5&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;7508&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;5382&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.716835&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;6&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;India&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1145&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;773&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.675109&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;7&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Australia&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;836&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;557&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.666268&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;8&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Argentina&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;253&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;166&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.656126&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;9&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Colombia&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;337&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;219&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.649852&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;10&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Chile&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;155&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;97&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.625806&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;11&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Philippines&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;393&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;240&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.610687&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;12&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;New Zealand&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;188&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;114&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.606383&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;13&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Venezuela, RB&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;145&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;81&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.558621&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;14&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Norway&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;410&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;222&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.541463&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q5Ra.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 6 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Aggregate Functions</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">Which aircraft types </span><span class="s1">(</span><span class="s2">Equipment codes</span><span class="s1">) </span><span class="s2">appear on the largest number of distinct routes</span>

<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question06 = &quot;&quot;&quot;</span>
<span class="s3">WITH expanded_equipment AS (</span>
    <span class="s3">SELECT</span>
        <span class="s3">r.&quot;Routes_ID&quot;,</span>
        <span class="s3">trim(equip) AS equipment</span>
    <span class="s3">FROM routes r,</span>
         <span class="s3">regexp_split_to_table(r.&quot;Equipment&quot;, ' ') AS equip</span>
    <span class="s3">WHERE trim(equip) &lt;&gt; ''</span>
<span class="s3">)</span>

<span class="s3">SELECT</span>
    <span class="s3">equipment,</span>
    <span class="s3">COUNT(DISTINCT &quot;Routes_ID&quot;) AS route_count</span>
<span class="s3">FROM expanded_equipment</span>
<span class="s3">GROUP BY equipment</span>
<span class="s3">ORDER BY route_count DESC</span>
<span class="s3">LIMIT 10;</span>
<span class="s3">&quot;&quot;&quot;</span>
<span class="s3">q6_df = pd.read_sql(query_question06, engine)</span>
<span class="s3">q6_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;equipment&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;route_count&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;320&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;14844&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;738&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;9745&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;319&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;7338&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;321&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;3379&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;737&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;2628&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;5&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;E90&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1816&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;6&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;AT7&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1529&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;7&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;333&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1517&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;8&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;73G&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1406&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;9&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;332&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1386&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q6RA.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 7 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Aggregate Functions</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">What is the average number of unique destination countries reachable from each country</span>


<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question7 = &quot;&quot;&quot;</span>
<span class="s3">SELECT</span>
    <span class="s3">origin_c.&quot;Country_Name&quot; AS origin_country,</span>
    <span class="s3">COUNT(DISTINCT dest_c.&quot;Country_Name&quot;) AS reachable_countries</span>
<span class="s3">FROM routes r</span>
<span class="s3">JOIN airports origin_a ON r.&quot;Source_airport&quot; = origin_a.&quot;IATA&quot;</span>
<span class="s3">JOIN countries origin_c ON origin_a.&quot;Country&quot; = origin_c.&quot;Country_Name&quot;</span>
<span class="s3">JOIN airports dest_a ON r.&quot;Destination_airport&quot; = dest_a.&quot;IATA&quot;</span>
<span class="s3">JOIN countries dest_c ON dest_a.&quot;Country&quot; = dest_c.&quot;Country_Name&quot;</span>
<span class="s3">GROUP BY origin_c.&quot;Country_Name&quot;</span>
<span class="s3">ORDER BY reachable_countries DESC;</span>
<span class="s3">&quot;&quot;&quot;</span>
<span class="s3">q7_df = pd.read_sql(query_question7, engine)</span>
<span class="s3">q7_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;origin_country&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;reachable_countries&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;France&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;112&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;United Kingdom&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;98&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;96&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;90&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Turkiye&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;90&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;...&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;217&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Falkland Islands&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;218&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Tuvalu&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;219&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Saint Pierre and Miquelon&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;220&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Niue&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;221&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Samoa&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;p&gt;222 rows × 2 columns&lt;/p&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q7RA.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 8 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Aggregate Functions</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">What are the top 5 countries where the ratio of total outgoing routes </span><span class="s1">(</span><span class="s2">from all airports in the country</span><span class="s1">) </span><span class="s2">to the country's GDP per Capita is the highest?</span>


<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question08 = &quot;&quot;&quot;</span>
<span class="s3">WITH outgoing_per_country AS (</span>
    <span class="s3">SELECT </span>
        <span class="s3">a.&quot;Country&quot;,</span>
        <span class="s3">COUNT(*) AS outgoing_routes</span>
    <span class="s3">FROM routes r</span>
    <span class="s3">JOIN airports a </span>
        <span class="s3">ON r.&quot;Source_airport_ID&quot; = a.&quot;Airport_ID&quot;</span>
    <span class="s3">GROUP BY a.&quot;Country&quot;</span>
<span class="s3">),</span>
<span class="s3">country_with_gdp AS (</span>
    <span class="s3">SELECT</span>
        <span class="s3">c.&quot;Country_Name&quot;,</span>
        <span class="s3">c.&quot;GDP_per_capita_current_US&quot;</span>
    <span class="s3">FROM countries c</span>
    <span class="s3">WHERE c.&quot;GDP_per_capita_current_US&quot; IS NOT NULL</span>
      <span class="s3">AND c.&quot;GDP_per_capita_current_US&quot; &gt; 0</span>
<span class="s3">)</span>
<span class="s3">SELECT </span>
    <span class="s3">og.&quot;Country&quot;,</span>
    <span class="s3">og.outgoing_routes,</span>
    <span class="s3">cg.&quot;GDP_per_capita_current_US&quot; AS gdp_per_capita,</span>
    <span class="s3">(og.outgoing_routes / cg.&quot;GDP_per_capita_current_US&quot;) AS ratio</span>
<span class="s3">FROM outgoing_per_country og</span>
<span class="s3">JOIN country_with_gdp cg</span>
    <span class="s3">ON og.&quot;Country&quot; = cg.&quot;Country_Name&quot;</span>
<span class="s3">ORDER BY ratio DESC</span>
<span class="s3">LIMIT 5;</span>
<span class="s3">&quot;&quot;&quot;</span>

<span class="s3">q8_df = pd.read_sql(query_question08, engine)</span>
<span class="s3">q8_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Country&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;outgoing_routes&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;gdp_per_capita&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;ratio&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;China&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;8013&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;12951.178240&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.618708&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;India&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1145&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;2530.120313&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.452548&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Pakistan&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;249&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1365.169274&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.182395&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Indonesia&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;817&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;4876.307745&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.167545&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Madagascar&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;65&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;508.718428&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;0.127772&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q8RA.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 9 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Aggregate Functions</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">Which airports have the largest disparity between the number of outgoing and incoming routes?</span>

<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question9 = &quot;&quot;&quot;</span>
<span class="s3">WITH outgoing AS (</span>
    <span class="s3">SELECT </span>
        <span class="s3">r.&quot;Source_airport_ID&quot; AS airport_id,</span>
        <span class="s3">COUNT(*) AS outgoing_count</span>
    <span class="s3">FROM routes r</span>
    <span class="s3">GROUP BY r.&quot;Source_airport_ID&quot;</span>
<span class="s3">),</span>
<span class="s3">incoming AS (</span>
    <span class="s3">SELECT </span>
        <span class="s3">r.&quot;Destination_airport_ID&quot; AS airport_id,</span>
        <span class="s3">COUNT(*) AS incoming_count</span>
    <span class="s3">FROM routes r</span>
    <span class="s3">GROUP BY r.&quot;Destination_airport_ID&quot;</span>
<span class="s3">),</span>
<span class="s3">combined AS (</span>
    <span class="s3">SELECT</span>
        <span class="s3">a.&quot;Airport_ID&quot;,</span>
        <span class="s3">a.&quot;Name&quot;,</span>
        <span class="s3">a.&quot;City&quot;,</span>
        <span class="s3">a.&quot;Country&quot;,</span>
        <span class="s3">COALESCE(o.outgoing_count, 0) AS outgoing_count,</span>
        <span class="s3">COALESCE(i.incoming_count, 0) AS incoming_count,</span>
        <span class="s3">ABS(COALESCE(o.outgoing_count, 0) - COALESCE(i.incoming_count, 0)) AS disparity</span>
    <span class="s3">FROM airports a</span>
    <span class="s3">LEFT JOIN outgoing o ON a.&quot;Airport_ID&quot; = o.airport_id</span>
    <span class="s3">LEFT JOIN incoming i ON a.&quot;Airport_ID&quot; = i.airport_id</span>
<span class="s3">)</span>
<span class="s3">SELECT *</span>
<span class="s3">FROM combined</span>
<span class="s3">ORDER BY disparity DESC</span>
<span class="s3">LIMIT 10;</span>
<span class="s3">&quot;&quot;&quot;</span>
<span class="s3">q9_df = pd.read_sql(query_question9, engine)</span>
<span class="s3">q9_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>
<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Airport_ID&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Name&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;City&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Country&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;outgoing_count&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;incoming_count&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;disparity&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;2006&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Auckland International Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Auckland&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;New Zealand&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;79&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;99&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;20&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;2074&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Prince Mohammad Bin Abdulaziz Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Madinah&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Saudi Arabia&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;34&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;50&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;16&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;73&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Halifax / Stanfield International Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Halifax&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Canada&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;19&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;30&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;11&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;4059&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Jomo Kenyatta International Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Nairobi&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Kenya&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;97&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;107&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;10&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;3941&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Eleftherios Venizelos International Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Athens&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Greece&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;166&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;176&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;10&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;5&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;1638&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Humberto Delgado Airport (Lisbon Portela Airport)&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Lisbon&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Portugal&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;194&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;202&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;8&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;6&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;3862&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Portland International Jetport Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Portland&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;1&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;9&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;8&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;7&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;346&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Munich Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Munich&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Germany&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;326&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;318&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;8&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;8&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;1382&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Charles de Gaulle International Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Paris&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;France&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;476&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;469&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;7&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;9&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;3861&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Louis Armstrong New Orleans International Airport&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;New Orleans&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;70&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;77&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;7&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q9RA.jpeg</span><span class="s1">)</span>

<span class="s0">## </span><span class="s2">Question 10 </span><span class="s1">(</span><span class="s2">Extended RA</span><span class="s1">: </span><span class="s2">Aggregate Functions</span><span class="s1">)</span>

<span class="s0">### </span><span class="s2">What are the top 10 cities globally, based on the total number of airports?</span>

<span class="s0">```</span><span class="s4">python</span>
<span class="s3">query_question10 = &quot;&quot;&quot;</span>
<span class="s3">SELECT </span>
    <span class="s3">a.&quot;City&quot;,</span>
    <span class="s3">a.&quot;Country&quot;,</span>
    <span class="s3">COUNT(*) AS airport_count,</span>
    <span class="s3">STRING_AGG(a.&quot;Name&quot;, ', ' ORDER BY a.&quot;Name&quot;) AS airport_names</span>
<span class="s3">FROM airports a</span>
<span class="s3">WHERE a.&quot;City&quot; IS NOT NULL</span>
  <span class="s3">AND a.&quot;City&quot; &lt;&gt; ''</span>
<span class="s3">GROUP BY a.&quot;City&quot;, a.&quot;Country&quot;</span>
<span class="s3">ORDER BY airport_count DESC</span>
<span class="s3">LIMIT 10;</span>
<span class="s3">&quot;&quot;&quot;</span>

<span class="s3">q10_df = pd.read_sql(query_question10, engine)</span>
<span class="s3">q10_df</span>
<span class="s0">```</span>

<span class="s1">**</span><span class="s2">Query Result</span><span class="s1">:**</span>

<span class="s1">&lt;div&gt;</span>

<span class="s1">&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;</span>
  <span class="s1">&lt;thead&gt;</span>
    <span class="s1">&lt;tr style=&quot;text-align: right;&quot;&gt;</span>
      <span class="s1">&lt;th&gt;&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;City&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;Country&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;airport_count&lt;/th&gt;</span>
      <span class="s1">&lt;th&gt;airport_names&lt;/th&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/thead&gt;</span>
  <span class="s1">&lt;tbody&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;0&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Columbus&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;8&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Bolton Field, Columbus Metropolitan Airport, C...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;1&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;New York&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;6&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Downtown-Manhattan/Wall St Heliport, Indianola...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;2&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Moscow&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Russian Federation&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;6&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Bykovo Airport, Domodedovo International Airpo...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;3&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;London&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United Kingdom&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;6&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;London City Airport, London Gatwick Airport, L...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;4&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Jacksonville&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;6&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Cecil Airport, Jacksonville Executive at Craig...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;5&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Houston&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;6&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Andrau Airpark, David Wayne Hooks Memorial Air...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;6&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Atlanta&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;5&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Cobb County-Mc Collum Field, DeKalb Peachtree ...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;7&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Greenville&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;United States&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;5&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Donaldson Field Airport, Greenville Downtown A...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;8&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Izmir&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Turkiye&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;5&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Adnan Menderes International Airport, Çiğli Ai...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
    <span class="s1">&lt;tr&gt;</span>
      <span class="s1">&lt;th&gt;9&lt;/th&gt;</span>
      <span class="s1">&lt;td&gt;Vancouver&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Canada&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;5&lt;/td&gt;</span>
      <span class="s1">&lt;td&gt;Coal Harbour Seaplane Base, Harbour (Public) H...&lt;/td&gt;</span>
    <span class="s1">&lt;/tr&gt;</span>
  <span class="s1">&lt;/tbody&gt;</span>
<span class="s1">&lt;/table&gt;</span>
<span class="s1">&lt;/div&gt;</span>

<span class="s1">![</span><span class="s2">Relational Algebra Diagram</span><span class="s1">](</span><span class="s2">Q10RA.jpeg</span><span class="s1">)</span>

</pre>
</body>
</html>